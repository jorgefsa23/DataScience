---
title: "Repor US Births (2000-2014)"
author: "Jorge Escobar"
date: "First created on: Nov 28, 2022. Last compiled: `r format(Sys.time(), '%b %d, %Y %H:%M:%S')`"
output:
  html_document:
      highlight: zenburn
      theme: readable
      toc: yes
      toc_float:
         collapsed: yes
         smooth_scroll: yes 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<!-- Personalizing CSS style -->
```{css, echo = FALSE}

p{
  text-align: justify;
  color: #696969
  }

h1{
  background-color: #f2e392;
  text-align: center;
  color: #5d0e16
}

h2,h3,h4,h5{
  background-color: #f1f5ad;
  text-align: left;
  color: #0000ff
}

```

## Introduction

This is an `R Marckdown` report developed in `R` language and RStudio IDE.

The Report was developed by data available in GitHub repository of [fivethirtyeight](https://github.com/fivethirtyeight/data/tree/master/births) behind the story *Some People Are Too Superstitious To Have A Baby On Friday The 13th*.

The file analyzed was `US_births_2000-2014_SSA.csv`. It contains U.S. births data for the years 2000 to 2014, as provided by the US Social Security Administration.

It has the following structure:

Header               |  Definition
---------------------|---------------------------------------------------
year                 | Year
month                | Month
date_of_month        | Day number of the month
day_of_week          | Day of week, where 1 is Monday and 7 is Sunday
births               | Number of births (of each day)


>On the next sections, the results of basic data analysis with R and a line-graph constructed with the package `ggplot`. Finally, a test of the hypothesis on incidence of Friday the 13 into number of births.
	
## Preparing environment
 
### Loading packages
<!-- If necessary, the packages must be installed before in RStudio -->
```{r message=FALSE, warning=FALSE}
library(tidyverse) # data treatment
```

### Database reading
```{r}
us_births <- read.table(file = "US_births_2000-2014_SSA.csv",
                     header = TRUE,
                     sep = ",",)
```

## Structure
```{r}
glimpse(us_births)
```
All columns were identified as *int* data type, some of them should be transformed into *factor*.\n
> The database has `r nrow(us_births)` rows and `r ncol(us_births)` columns.
Otherwise, the database dimension is: `r dim(us_births)`

### Visualizing the first 3 rows

```{r}
us_births %>% 
  head(3) 
```
> The function head() with parameter (3) shows the first lines. The function `kable()` allows to visualize as a table.

The names of the columns are: `r names(us_births)`.

## Data transformation
As mentioned before, some data are of type **int* while we need to read them as *factor*.\n
Columns: "year", "month", "date_of_month" and "day_of_week" are transformed by the function `mutate`.

```{r}
us_births <- us_births %>%
              mutate(year = as.factor(year),
                     month = as.factor(month),
                     date_of_month = as.factor(date_of_month),
                     day_of_week = as.factor(day_of_week))

glimpse(us_births)
```

## Data Analysis
The function `tapply` is an easy way to visualize basic statistics (transforming columns into objects with the function `attach`).\n
To a better representation of the result, we can also use the function `group_by`

### Mean and SD of births by month:
```{r}
us_births %>% 
  group_by(month) %>% 
  summarise(mean_month = mean(births),
            sd_month = sd(births))
```

### Mean and SD of births by day of the week:
```{r}
us_births %>% 
  group_by(day_of_week) %>% 
  summarise(mean_month = mean(births),
            sd_month = sd(births))
```

### Mean and SD of births by year:
```{r}
us_births %>% 
  group_by(year) %>% 
  summarise(mean_month = mean(births),
            sd_month = sd(births))
```

## Graphic plot
We will organize data with the function `group_by`. Lets organize data by year to sum total of births by year.
```{r}
us_births_groupby <- us_births %>% 
                          group_by(year) %>% 
                          summarise(total_year = sum(births))

us_births_groupby
```

The plot area is prepared by the function `ggplot`:

```{r}
ggplot(us_births_groupby, aes(x=year, y=total_year, group=1)) +
  geom_line()+
  geom_point()+
  labs(x = "Year", 
       y = "Number of Births",
       title = "Births by year (2000-2014") 
```

## Hypothesis: Friday the 13 has incidence into birth numbers.

### Babies on Fridays:
We will filter (function `filter`) the births when the day of the week is "5" (Friday), and store it into a new database, observing the mean of births for this day (we already observed its value on the first section).
```{r}
friday <- us_births %>% 
  filter(day_of_week == '5') 

mean(friday$births)
```

### Babies on Friday the 13:
A double filter will show us all births on Friday (day_of_week == '5') and date 13 ( date_of_month == '13'), and again, observe the mean of births.
```{r}
friday13 <- us_births %>% 
  filter(day_of_week == '5', 
         date_of_month == '13')

mean(friday13$births)
```

We can also, observe the mean of births for each month.
```{r}
friday13 %>% 
  group_by(month) %>% 
  summarise(mean_month = mean(births),
            sd_month = sd(births))
```

## Conclusion 

> The results show a mean of 12596 when the day is Friday, and a mean of 11950 when it is Friday the 13.\n
The difference between those means is 646 births. That could be considered as not enought significant. This result can indicate that in fact some people could avoided this data, but their number is not significant into the general demand of hospitals.